<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <!-- SIA Order Report Action (Collector's Order) -->
    <record id="action_report_sia_order" model="ir.actions.report">
        <field name="name">SIA Order</field>
        <field name="model">bhu.sia.team</field>
        <field name="report_type">qweb-pdf</field>
        <field name="report_name">bhuarjan.sia_order_report</field>
        <field name="report_file">bhuarjan.sia_order_report</field>
        <field name="paperformat_id" ref="bhuarjan.bhuarjan_sia_paper_format"/>
        <field name="print_report_name">'SIA_Order_' + ((object and object.project_id and object.project_id.name) or (docs and docs[0] and docs[0].project_id and docs[0].project_id.name) or 'Project') + '_' + ((object and object.create_date and object.create_date.strftime('%Y%m%d')) or (docs and docs[0] and docs[0].create_date and docs[0].create_date.strftime('%Y%m%d')) or 'Date')</field>
    </record>

    <!-- SIA Order Report Template (Collector's Order) -->
    <template id="sia_order_report">
        <t t-call="web.html_container">
            <meta charset="utf-8"/>
            <t t-foreach="docs" t-as="sia_team">
                <t t-call="web.basic_layout">
                <!-- Include centralized CSS styles -->
                <t t-call="bhuarjan.report_common_styles"/>
                <!-- Report-specific overrides for SIA Order (Collector's Order) -->
                <style>
                    .normal-text {
                        font-size: 21px !important;
                    }
                    .normal-text p, .normal-text span, .normal-text strong {
                        font-size: 21px !important;
                    }
                    .table-header {
                        font-size: 21px !important;
                    }
                    .fsc {
                        font-size: 21px !important;
                    }
                    .date-reference-section span {
                        font-size: 21px !important;
                    }
                    table td, table th {
                        font-size: 21px !important;
                    }
                    .subject-section, .body-section {
                        font-size: 21px !important;
                    }
                    .subject-section p, .body-section p {
                        font-size: 21px !important;
                    }
                </style>

                <div class="container letter_space" style="border: 2px dotted #000; padding: 15px; margin: 10px; position: relative; min-height: calc(100vh - 20px); height: 100%;">
                    <!-- Watermark with Logo - Centered on Page (using common CSS) -->
                    <div class="watermark">
                        <div class="watermark-circle"></div>
                        <t t-set="base_url" t-value="request.env['ir.config_parameter'].sudo().get_param('web.base.url')"/>
                        <img t-att-src="base_url + '/bhuarjan/static/img/logo.png'" alt="Logo Watermark"/>
                    </div>
                    
                    <!-- Header with Logo and QR Code -->
                    <div style="margin-bottom: 15px; padding-bottom: 8px;">
                        <table style="width: 100%; border:1px solid white; margin-bottom: 8px;">
                            <tr>
                                <!-- Logo on Left -->
                                <td rowspan="2" style="width: 12%; padding: 0; text-align: center; vertical-align: middle;">
                                    <t t-set="base_url" t-value="request.env['ir.config_parameter'].sudo().get_param('web.base.url')"/>
                                    <img t-att-src="base_url + '/bhuarjan/static/img/logo.png'" class="header-logo" alt="Logo"/>
                                </td>
                                <!-- Header Text - Line 1 -->
                                <td colspan="2" style="text-align: center; vertical-align: middle; padding: 0 5px;">
                                    <h3 class="hindi letter_space header-text" style="margin: 0; padding: 0; font-size: 26px; line-height: 0.95;">
                                        कार्यालय कलेक्टर (भू-अर्जन शाखा) रायगढ़ (छत्तीसगढ़)
                                    </h3>
                                </td>
                                <!-- QR Code on Right -->
                                <td rowspan="2" style="width: 12%; padding: 0; text-align: center; vertical-align: middle;">
                                    <t t-set="qr_code_img" t-value="sia_team.get_qr_code_data()"/>
                                    <t t-set="qr_download_url" t-value="'https://bhuarjan.com/bhuarjan/sia/' + str(sia_team.sia_team_uuid or '') + '/download'"/>
                                    <t t-if="qr_code_img">
                                        <a t-att-href="qr_download_url" style="display: block; width: 90%; margin: 0 auto; padding: 0; text-decoration: none;">
                                            <img t-att-src="'data:image/png;base64,' + qr_code_img" 
                                                 alt="QR Code - Click to download PDF" 
                                                 style="width: 90%; max-width: 90%; height: auto; aspect-ratio: 1; border: none; display: block; margin: 0; padding: 0; object-fit: contain;"/>
                                        </a>
                                    </t>
                                    <t t-if="not qr_code_img">
                                        <a t-att-href="qr_download_url" style="display: block; width: 90%; margin: 0 auto; padding: 0; text-decoration: none;">
                                            <div style="width: 90%; padding-top: 90%; position: relative; border: none; background: white; margin: 0;">
                                                <div style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; display: flex; align-items: center; justify-content: center;">
                                                    <div style="text-align: center; font-size: 7px;">
                                                        <div style="font-weight: bold;">QR Code</div>
                                                    </div>
                                                </div>
                                            </div>
                                        </a>
                                    </t>
                                </td>
                            </tr>
                            <tr>
                                <!-- Header Text - Line 2 -->
                                <td colspan="2" style="text-align: center; vertical-align: middle; padding: 0 5px;">
                                    <h3 class="hindi letter_space header-text" style="margin: 0; padding: 0; font-size: 26px; line-height: 0.95;">
                                        //आदेश//
                                    </h3>
                                </td>
                            </tr>
                        </table>
                    </div>

                    <!-- Reference and Date -->
                    <div class="date-reference-section row w-100" style="margin-bottom: 12px !important; display: flex; justify-content: space-between;">
                        <div class="col w-100 normal-text letter_space" style="flex: 1;">
                                <strong>क्रमांक /</strong>
                                <span t-if="sia_team.kramank" t-esc="sia_team.kramank"/>
                                <span t-if="not sia_team.kramank">.....................</span>
                                /
                        </div>
                        <div class="col normal-text letter_space text-right w-100" style="flex: 1; text-align: right !important;">
                                <strong>रायगढ़, दिनांक /</strong>........................./<span t-if="sia_team.create_date" t-esc="sia_team.create_date.strftime('%Y')"/><span t-if="not sia_team.create_date">2025</span>
                        </div>
                    </div>

                    <!-- SDM Logic (Moved up for use in first paragraph) -->
                    <t t-set="subdivision_name" t-value="''"/>
                    <t t-if="sia_team.sub_division_id">
                        <t t-set="subdivision_name" t-value="sia_team.sub_division_id.name"/>
                    </t>
                    <t t-if="not sia_team.sub_division_id and sia_team.project_id and sia_team.project_id.sdm_ids and len(sia_team.project_id.sdm_ids) > 0">
                        <t t-set="first_sdm" t-value="sia_team.project_id.sdm_ids[0]"/>
                        <t t-if="first_sdm.sub_division_ids and len(first_sdm.sub_division_ids) > 0">
                            <t t-set="subdivision_name" t-value="first_sdm.sub_division_ids[0].name"/>
                        </t>
                    </t>

                    <!-- Main Body Paragraph (Replaces Subject and Old Body) -->
                    <div class="body-section" style="margin-bottom: 5px !important; margin-top: 15px !important;">
                        <p class="normal-text letter_space" style="margin: 5px 0 !important; text-align: justify !important; line-height: 1.5 !important; text-indent: 0 !important; font-size: 21px !important;">
                            &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<strong>अनुविभागीय अधिकारी (राजस्व) सह भू-अर्जन अधिकारी,</strong> <span t-esc="subdivision_name if subdivision_name else '........................'"/> <strong>द्वारा विभाग</strong> <span t-esc="sia_team.requiring_body_id.name if sia_team.requiring_body_id else '........................'"/> <strong>(छ.ग.) अंतर्गत परियोजना</strong> <span t-esc="sia_team.project_id.name or '........................'"/> <strong>निर्माण हेतु प्रभावित ग्राम</strong> 
                            <t t-if="sia_team.village_ids">
                                <t t-foreach="sia_team.village_ids" t-as="village" t-first="first">
                                    <t t-if="not first">, </t><span t-esc="village.name or ''"/>
                                </t>
                            </t>
                            <t t-if="not sia_team.village_ids and sia_team.project_id and sia_team.project_id.village_ids">
                                <t t-foreach="sia_team.project_id.village_ids" t-as="village" t-first="first">
                                    <t t-if="not first">, </t><span t-esc="village.name or ''"/>
                                </t>
                            </t>
                            <t t-if="not sia_team.village_ids and (not sia_team.project_id or not sia_team.project_id.village_ids)">
                                ........................
                            </t>
                            <strong>तहसील</strong>&#160;
                            <t t-if="sia_team.tehsil_ids">
                                <t t-foreach="sia_team.tehsil_ids" t-as="tehsil" t-first="first">
                                    <t t-if="not first">&#160;</t><span t-esc="tehsil.name or ''"/>
                                </t>
                            </t>
                            <t t-if="not sia_team.tehsil_ids">
                                ........................
                            </t>
                            &#160;<strong>जिला</strong> 
                            <t t-if="sia_team.project_id and sia_team.project_id.village_ids and len(sia_team.project_id.village_ids) > 0">
                                <span t-esc="sia_team.project_id.village_ids[0].district_id.name if sia_team.project_id.village_ids[0].district_id else 'रायगढ़'"/>
                            </t>
                            <t t-if="not (sia_team.project_id and sia_team.project_id.village_ids and len(sia_team.project_id.village_ids) > 0)">
                                रायगढ़
                            </t>
                            <strong>(छ.ग.) की निजी भूमि कुल रकबा</strong>&#160;
                            <t t-if="sia_team.total_area_acquired and sia_team.total_area_acquired > 0">
                                <span t-esc="'{:,.4f}'.format(sia_team.total_area_acquired)"/>
                            </t>
                            <t t-if="not sia_team.total_area_acquired or sia_team.total_area_acquired == 0">
                                ........................
                            </t>
                            <strong>हेक्टेयर भूमि के भू-अर्जन प्रस्ताव पर, सामाजिक समाघात निर्धारण हेतु दल गठन का प्रस्ताव प्रस्तुत किया गया है, जो निम्नानुसार है :-</strong>
                        </p>
                    </div>

                    <!-- Team Members Table -->
                    <div style="margin-bottom: 15px; margin-top: 10px;">
                        <table class="w-100" style="border-collapse: collapse; border: 2px solid #000; margin-top: 8px;">
                            <thead>
                                <tr>
                                    <th class="table-header letter_space" style="border: 1px solid #000; padding: 6px; text-align: left; background-color: #f5f5f5; width: 45%;">
                                        समाजिक समाघात निर्धारण दल का विवरण
                                    </th>
                                    <th class="table-header letter_space" style="border: 1px solid #000; padding: 6px; text-align: left; background-color: #f5f5f5; width: 55%;">
                                        सदस्य का नाम / पता
                                    </th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- (क) Non-Government Social Scientist -->
                                <tr>
                                    <td class="normal-text letter_space" style="border: 1px solid #000; padding: 4px; vertical-align: top; background-color: #fafafa; text-align: left;">
                                        <strong>(क) गैर शासकीय सामाजिक वैज्ञानिक</strong>
                                    </td>
                                    <td class="normal-text letter_space" style="border: 1px solid #000; padding: 4px; text-align: left;">
                                        <t t-if="sia_team.non_govt_social_scientist_line_ids">
                                            <t t-foreach="sia_team.non_govt_social_scientist_line_ids" t-as="member">
                                                <p style="margin: 1px 0; line-height: 1.3; text-align: left;">
                                                    <span t-esc="member_index + 1"/>. 
                                                    <span t-esc="member.name or ''"/>
                                                    <t t-if="member.post">, <span t-esc="member.post"/></t>
                                                    <t t-if="member.address">, <span t-esc="member.address"/></t>
                                                </p>
                                            </t>
                                        </t>
                                        <t t-if="not sia_team.non_govt_social_scientist_line_ids">
                                            <p style="margin: 1px 0; text-align: left;">........................</p>
                                        </t>
                                    </td>
                                </tr>

                                <!-- (ख) Representatives of Local Bodies -->
                                <tr>
                                    <td class="normal-text letter_space" style="border: 1px solid #000; padding: 4px; vertical-align: top; background-color: #fafafa; text-align: left;">
                                        <strong>(ख) स्थानीय निकायों के प्रतिनिधि</strong>
                                    </td>
                                    <td class="normal-text letter_space" style="border: 1px solid #000; padding: 4px; text-align: left;">
                                        <t t-if="sia_team.local_bodies_representative_line_ids">
                                            <t t-foreach="sia_team.local_bodies_representative_line_ids" t-as="member">
                                                <p style="margin: 1px 0; line-height: 1.3; text-align: left;">
                                                    <span t-esc="member_index + 1"/>. 
                                                    <span t-esc="member.name or ''"/>
                                                    <t t-if="member.post">, <span t-esc="member.post"/></t>
                                                    <t t-if="member.address">, <span t-esc="member.address"/></t>
                                                </p>
                                            </t>
                                        </t>
                                        <t t-if="not sia_team.local_bodies_representative_line_ids">
                                            <p style="margin: 1px 0; text-align: left;">........................</p>
                                        </t>
                                    </td>
                                </tr>

                                <!-- (ग) Resettlement Expert -->
                                <tr>
                                    <td class="normal-text letter_space" style="border: 1px solid #000; padding: 4px; vertical-align: top; background-color: #fafafa; text-align: left;">
                                        <strong>(ग) पुनर्व्यवस्थापन विशेषज्ञ</strong>
                                    </td>
                                    <td class="normal-text letter_space" style="border: 1px solid #000; padding: 4px; text-align: left;">
                                        <t t-if="sia_team.resettlement_expert_line_ids">
                                            <t t-foreach="sia_team.resettlement_expert_line_ids" t-as="member">
                                                <p style="margin: 1px 0; line-height: 1.3; text-align: left;">
                                                    <span t-esc="member_index + 1"/>. 
                                                    <span t-esc="member.name or ''"/>
                                                    <t t-if="member.post">, <span t-esc="member.post"/></t>
                                                    <t t-if="member.address">, <span t-esc="member.address"/></t>
                                                </p>
                                            </t>
                                        </t>
                                        <t t-if="not sia_team.resettlement_expert_line_ids">
                                            <p style="margin: 1px 0; text-align: left;">........................</p>
                                        </t>
                                    </td>
                                </tr>

                                <!-- (घ) Technical Expert -->
                                <tr>
                                    <td class="normal-text letter_space" style="border: 1px solid #000; padding: 4px; vertical-align: top; background-color: #fafafa; text-align: left;">
                                        <strong>(घ) परियोजना से संबंधित विषय का तकनीकी विशेषज्ञ</strong>
                                    </td>
                                    <td class="normal-text letter_space" style="border: 1px solid #000; padding: 4px; text-align: left;">
                                        <t t-if="sia_team.technical_expert_line_ids">
                                            <t t-foreach="sia_team.technical_expert_line_ids" t-as="member">
                                                <p style="margin: 1px 0; line-height: 1.3; text-align: left;">
                                                    <span t-esc="member_index + 1"/>. 
                                                    <span t-esc="member.name or ''"/>
                                                    <t t-if="member.post">, <span t-esc="member.post"/></t>
                                                    <t t-if="member.address">, <span t-esc="member.address"/></t>
                                                </p>
                                            </t>
                                        </t>
                                        <t t-if="not sia_team.technical_expert_line_ids">
                                            <p style="margin: 1px 0; text-align: left;">........................</p>
                                        </t>
                                    </td>
                                </tr>

                                <!-- (ड.) Tehsildar -->
                                <tr>
                                    <td class="normal-text letter_space" style="border: 1px solid #000; padding: 4px; vertical-align: top; background-color: #fafafa; text-align: left;">
                                        <strong>(ड.) प्रभावित क्षेत्र का तहसीलदार</strong>
                                    </td>
                                    <td class="normal-text letter_space" style="border: 1px solid #000; padding: 4px; text-align: left;">
                                        <t t-set="project_tehsildar" t-value="sia_team.project_id and sia_team.project_id.tehsildar_ids and len(sia_team.project_id.tehsildar_ids) > 0 and sia_team.project_id.tehsildar_ids[0] or False"/>
                                        <t t-if="project_tehsildar">
                                            <t t-set="tehsildar_tehsil" t-value="project_tehsildar.tehsil_ids and len(project_tehsildar.tehsil_ids) > 0 and project_tehsildar.tehsil_ids[0].name or ''"/>
                                            <p style="margin: 1px 0; line-height: 1.3; text-align: left;">
                                                <span t-esc="project_tehsildar.name or ''"/>, तहसीलदार <span t-esc="tehsildar_tehsil"/> (संयोजक)
                                            </p>
                                        </t>
                                        <t t-if="not project_tehsildar">
                                            <p style="margin: 1px 0; text-align: left;">........................</p>
                                        </t>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- Team Roles and Responsibilities -->
                    <div class="body-section" style="margin-bottom: 15px !important; margin-top: 10px !important;">
                        <p class="normal-text letter_space" style="margin: 5px 0 !important; text-align: justify !important; line-height: 1.5 !important; text-indent: 0 !important; font-size: 21px !important;">
                            &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;उपरोक्त प्रस्ताव अनुसार दल का गठन किया जाता है। सारणी में क्रमांक “क” अध्यक्ष तथा क्रमांक “ख” से “घ” समिति के सदस्य होंगे। उक्त समिति अनुविभागीय अधिकारी (राजस्व) सह भू-अर्जन अधिकारी, <span t-esc="subdivision_name if subdivision_name else '........................'"/> जो पुनर्वास प्रशासक है, के मार्गदर्शन में सामाजिक समाघात निर्धारण संबंधी कार्यवाही नियमानुसार पूर्ण करेंगे एवं प्रतिवेदन पुनर्वास प्रशासक को समय-सीमा के भीतर प्रस्तुत करेंगे।
                        </p>
                    </div>

                    <!-- Issuing Authority -->
                    <div class="footer-section" style="margin-top: 80px !important; margin-bottom: 15px !important;">
                        <p class="normal-text letter_space" style="margin: 5px 0 !important; text-align: right !important; line-height: 1.5 !important; font-size: 21px !important;">
                            <strong style="font-size: 21px !important;">कलेक्टर रायगढ़ (छ.ग.)</strong>
                        </p>
                    </div>

                    <!-- Copy Distribution -->
                    <div style="margin-top: 20px; padding-top: 10px;">
                        <!-- क्रमांक and दिनांक Section -->
                        <div class="date-reference-section" style="margin-bottom: 10px !important; display: flex; justify-content: space-between;">
                            <span class="normal-text letter_space" style="font-weight: bold !important; font-size: 21px !important; flex: 1;">
                                <strong>पृ. क्रमांक /</strong>
                                <span t-if="sia_team.kramank" t-esc="sia_team.kramank"/>
                                <span t-if="not sia_team.kramank">.....................</span>
                                /
                            </span>
                            <span class="normal-text letter_space" style="text-align: right !important; font-weight: bold !important; font-size: 21px !important; flex: 1;">
                                <strong>रायगढ़, दिनांक /</strong>........................./<span t-if="sia_team.create_date" t-esc="sia_team.create_date.strftime('%Y')"/><span t-if="not sia_team.create_date">2025</span>
                            </span>
                        </div>
                        
                        <!-- प्रतिलिपि Section -->
                        <div style="margin-bottom: 10px !important;">
                            <p class="normal-text letter_space" style="margin: 5px 0 !important; line-height: 1.5 !important; font-size: 21px !important;">
                                <strong style="font-size: 21px !important;">प्रतिलिपिः-</strong>
                            </p>
                        </div>
                        
                        <!-- Copy Distribution List -->
                        <div style="margin-bottom: 10px !important;">
                            <p class="normal-text letter_space" style="margin: 5px 0 !important; line-height: 1.5 !important; font-size: 21px !important;">
                                1. सचिव, छ.ग. शासन, राजस्व एवं आपदा प्रबंधन विभाग, मंत्रालय महानदी भवन, रायपुर की ओर सूचनार्थ एवं आवश्यक कार्यवाही हेतु।
                            </p>
                            <p class="normal-text letter_space" style="margin: 5px 0 !important; line-height: 1.5 !important; font-size: 21px !important;">
                                2. आयुक्त, बिलासपुर संभाग बिलासपुर की ओर सूचनार्थ एवं आवश्यक कार्यवाही हेतु।
                            </p>
                            <p class="normal-text letter_space" style="margin: 5px 0 !important; line-height: 1.5 !important; font-size: 21px !important;">
                                3. अनुविभागीय अधिकारी (राजस्व) सह भू-अर्जन अधिकारी, 
                            <t t-set="subdivision_name_copy" t-value="''"/>
                            <t t-if="sia_team.sub_division_id">
                                <t t-set="subdivision_name_copy" t-value="sia_team.sub_division_id.name"/>
                            </t>
                            <t t-if="not sia_team.sub_division_id and sia_team.project_id and sia_team.project_id.sdm_ids and len(sia_team.project_id.sdm_ids) > 0">
                                <t t-set="first_sdm_copy" t-value="sia_team.project_id.sdm_ids[0]"/>
                                <t t-if="first_sdm_copy.sub_division_ids and len(first_sdm_copy.sub_division_ids) > 0">
                                    <t t-set="subdivision_name_copy" t-value="first_sdm_copy.sub_division_ids[0].name"/>
                                </t>
                            </t>
                            <span t-esc="subdivision_name_copy if subdivision_name_copy else '........................'"/> जिला रायगढ़ (छ.ग.) की ओर रिपोर्ट प्रस्तुत करने पर आवश्यक कार्यवाही सुनिश्चित करने हेतु।
                            </p>
                            <p class="normal-text letter_space" style="margin: 5px 0 !important; line-height: 1.5 !important; font-size: 21px !important;">
                                4. विभाग. <span style="font-size: 21px !important;" t-esc="sia_team.requiring_body_id.name if sia_team.requiring_body_id else '........................'"/> रायगढ़ (छ.ग.) की ओर सूचनार्थ एवं आवश्यक कार्यवाही हेतु।
                            </p>
                            <p class="normal-text letter_space" style="margin: 5px 0 !important; line-height: 1.5 !important; font-size: 21px !important;">
                                5. दल के सभी संबंधित अधिकारियों की ओर।
                            </p>
                        </div>
                        
                        <!-- Signature Block -->
                        <p class="normal-text letter_space footer-section" style="margin: 10px 0 5px 0 !important; text-align: right !important; line-height: 1.5 !important; font-size: 21px !important;">
                            <strong style="font-size: 21px !important;">अपर कलेक्टर रायगढ़ (छ.ग.)</strong>
                        </p>
                    </div>
                </div>
                </t>
            </t>
        </t>
        <!-- Footer Section Name -->
        <div class="footer-section-name">SIA Order / SIA आदेश</div>
    </template>
</odoo>

