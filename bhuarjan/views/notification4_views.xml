<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Notification 4 List View -->
    <record id="view_bhu_notification4_list" model="ir.ui.view">
        <field name="name">bhu.notification4.list</field>
        <field name="model">bhu.notification4</field>
        <field name="arch" type="xml">
            <list string="Notification 4 / अधिसूचना 4" decoration-info="state == 'draft'" decoration-success="state == 'published'" decoration-danger="state == 'cancelled'">
                <field name="name"/>
                <field name="notification_date"/>
                <field name="district_id"/>
                <field name="tehsil_id"/>
                <field name="village_id"/>
                <field name="total_area"/>
                <field name="state" widget="badge"/>
            </list>
        </field>
    </record>


    <!-- Notification 4 Form View -->
    <record id="view_bhu_notification4_form" model="ir.ui.view">
        <field name="name">bhu.notification4.form</field>
        <field name="model">bhu.notification4</field>
        <field name="arch" type="xml">
            <form string="Notification 4 / अधिसूचना 4">
                <header>
                    <button name="action_publish" string="Publish / प्रकाशित करें" type="object" class="btn-primary" invisible="state != 'draft'"/>
                    <button name="action_cancel" string="Cancel / रद्द करें" type="object" class="btn-danger" invisible="state == 'cancelled'"/>
                    <button name="action_draft" string="Reset to Draft / प्रारूप में रीसेट" type="object" invisible="state != 'cancelled'"/>
                    <button name="action_fetch_survey_details" string="Fetch Survey Details / सर्वे विवरण प्राप्त करें" type="object" class="btn-primary" invisible="state != 'draft'"/>
                    <button name="action_download_notification" string="Download PDF / PDF डाउनलोड करें" type="object" class="btn-success" icon="fa-download"/>
                    <field name="state" widget="statusbar" statusbar_visible="draft,published"/>
                </header>
                <sheet>
                    <div class="oe_title">
                        <h1>
                            <field name="name" placeholder="Notification Number / अधिसूचना नंबर"/>
                        </h1>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <group string="Basic Information / मूल जानकारी">
                                <field name="notification_date" widget="date"/>
                                <field name="public_purpose" widget="text"/>
                            </group>
                        </div>
                        <div class="col-md-6">
                            <group string="Location Information / स्थान की जानकारी">
                                <field name="district_id" widget="selection"/>
                                <field name="tehsil_id" widget="selection"/>
                                <field name="village_id" widget="selection"/>
                                <field name="total_area" widget="float" readonly="1"/>
                            </group>
                        </div>
                    </div>
                    
                    
                    <notebook>
                        <!-- Survey Tab -->
                        <page string="Survey Details / सर्वे विवरण" name="survey_details" icon="fa fa-map-marker">
                            <group>
                                <group string="Public Hearing Details / सार्वजनिक सुनवाई विवरण">
                                    <field name="hearing_date" widget="date"/>
                                    <field name="hearing_time" widget="char" placeholder="e.g., 10:00 AM"/>
                                    <field name="hearing_location" widget="char" placeholder="Enter hearing location"/>
                                </group>
                                <group string="Signature Information / हस्ताक्षर जानकारी">
                                    <field name="signature_place" widget="char" placeholder="Enter signature place"/>
                                    <field name="signature_date" widget="date"/>
                                </group>
                            </group>
                        </page>
                        
                        <!-- SIA Tab -->
                        <page string="SIA Details / SIA विवरण" name="sia_details" icon="fa fa-users">
                            <group>
                                <group string="Basic Information / मूल जानकारी">
                                    <field name="brief_public_purpose" widget="text" nolabel="1" placeholder="(1) लोक प्रयोजन का संक्षिप्त विवरण।"/>
                                </group>
                            </group>
                            
                            <group>
                                <group string="Affected Families / प्रभावित परिवार">
                                    <field name="direct_affected_families" widget="integer"/>
                                    <field name="indirect_affected_families" widget="integer"/>
                                </group>
                                <group string="Assets Information / परिसंपत्ति जानकारी">
                                    <field name="private_assets_count" widget="integer"/>
                                    <field name="govt_assets_count" widget="integer"/>
                                </group>
                            </group>
                            
                            <group>
                                <group string="Acquisition Details / अधिग्रहण विवरण">
                                    <field name="is_acquisition_minimum" widget="boolean_toggle"/>
                                </group>
                                <group string="Project Cost / परियोजना लागत">
                                    <field name="project_total_cost" widget="monetary"/>
                                </group>
                            </group>
                            
                            <group>
                                <group string="Alternative Site / वैकल्पिक स्थल">
                                    <field name="alternative_site_feasibility" widget="text" nolabel="1" placeholder="(7) संभावित वैकल्पिक स्थल तथा उसकी व्यवहार्यता पर विचार।"/>
                                </group>
                            </group>
                            
                            <group>
                                <group string="Project Benefits / परियोजना लाभ">
                                    <field name="project_benefits" widget="text" nolabel="1" placeholder="(9) परियोजना से होने वाले लाभ।"/>
                                </group>
                            </group>
                            
                            <group>
                                <group string="Compensation Framework / प्रतिकर ढांचा">
                                    <field name="compensation_framework" widget="text" nolabel="1" placeholder="Enter compensation framework details"/>
                                </group>
                            </group>
                            
                            <group>
                                <group string="Other Affected Factors / अन्य प्रभावित कारक">
                                    <field name="other_affected_factors" widget="text" nolabel="1" placeholder="Enter other factors that may be affected"/>
                                </group>
                            </group>
                        </page>
                        
                        <!-- Related Surveys Tab -->
                        <page  name="related_surveys" icon="fa fa-list-alt">
                            <group>
                                <field name="survey_ids" readonly="1" widget="one2many" context="{'tree_view_ref': 'bhuarjan.view_survey_details_tree'}"/>
                            </group>
                        </page>
                    </notebook>
                </sheet>
            </form>
        </field>
    </record>

    <!-- Notification 4 Search View -->
    <record id="view_bhu_notification4_search" model="ir.ui.view">
        <field name="name">bhu.notification4.search</field>
        <field name="model">bhu.notification4</field>
        <field name="arch" type="xml">
            <search string="Search Notifications / अधिसूचना खोजें">
                <field name="name"/>
                <field name="district_id"/>
                <field name="tehsil_id"/>
                <field name="village_id"/>
                <field name="notification_date"/>
                
                <filter string="Draft / प्रारूप" name="draft" domain="[('state', '=', 'draft')]"/>
                <filter string="Published / प्रकाशित" name="published" domain="[('state', '=', 'published')]"/>
                <filter string="Cancelled / रद्द" name="cancelled" domain="[('state', '=', 'cancelled')]"/>
                
                <separator/>
                <filter string="This Month / इस महीने" name="this_month" domain="[('notification_date', '>=', (context_today() - relativedelta(months=1)).strftime('%Y-%m-01')), ('notification_date', '&lt;', (context_today() + relativedelta(months=1)).strftime('%Y-%m-01'))]"/>
                <filter string="This Year / इस साल" name="this_year" domain="[('notification_date', '>=', context_today().strftime('%Y-01-01')), ('notification_date', '&lt;', (context_today() + relativedelta(years=1)).strftime('%Y-01-01'))]"/>
                
                <group expand="0" string="Group By / समूह बनाएं">
                    <filter string="State / स्थिति" name="group_state" context="{'group_by': 'state'}"/>
                    <filter string="District / जिला" name="group_district" context="{'group_by': 'district_id'}"/>
                    <filter string="Tehsil / तहसील" name="group_tehsil" context="{'group_by': 'tehsil_id'}"/>
                    <filter string="Village / ग्राम" name="group_village" context="{'group_by': 'village_id'}"/>
                    <filter string="Notification Date / अधिसूचना दिनाँक" name="group_notification_date" context="{'group_by': 'notification_date'}"/>
                </group>
            </search>
        </field>
    </record>

    <!-- Notification 4 Action -->
    <record id="action_bhu_notification4" model="ir.actions.act_window">
        <field name="name">Notification 4 / अधिसूचना 4</field>
        <field name="res_model">bhu.notification4</field>
        <field name="view_mode">list,form</field>
        <field name="search_view_id" ref="view_bhu_notification4_search"/>
        <field name="context">{'search_default_this_year': 1}</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Generate your first Notification 4!
            </p>
            
            <p>
                Use the "Generate Notification 4" button to create notifications for specific villages.
                This will automatically create notifications for all khasras in the selected village.
            </p>
        </field>
    </record>

    <!-- Survey Details Tree View for Notification 4 -->
    <record id="view_survey_details_tree" model="ir.ui.view">
        <field name="name">survey.details.tree</field>
        <field name="model">bhu.survey</field>
        <field name="arch" type="xml">
            <list string="Survey Details / सर्वे विवरण" create="false" edit="false" delete="false">
                <field name="name"/>
                <field name="project_id"/>
                <field name="department_id"/>
                <field name="village_id"/>
                <field name="tehsil_id"/>
                <field name="district_name"/>
                <field name="khasra_number"/>
                <field name="total_area"/>
                <field name="acquired_area"/>
                <field name="survey_date"/>
                <field name="state" widget="badge"/>
                <field name="is_single_crop"/>
                <field name="is_double_crop"/>
                <field name="is_irrigated"/>
                <field name="is_unirrigated"/>
                <field name="tree_development_stage"/>
                <field name="tree_count"/>
                <field name="house_type"/>
                <field name="house_area"/>
                <field name="shed_area"/>
                <field name="has_well"/>
                <field name="well_type"/>
                <field name="has_electricity"/>
                <field name="has_road_access"/>
                <field name="has_tubewell"/>
                <field name="has_pond"/>
                <field name="landowner_ids" widget="many2many_tags"/>
            </list>
        </field>
    </record>

</odoo>
