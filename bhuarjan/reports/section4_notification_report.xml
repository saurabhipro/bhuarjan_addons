<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <!-- Section 4 Notification Report -->
    <record id="action_report_section4_notification" model="ir.actions.report">
        <field name="name">Section 4 Notification / धारा 4 अधिसूचना</field>
        <field name="model">bhu.section4.notification.wizard</field>
        <field name="report_type">qweb-pdf</field>
        <field name="report_name">bhuarjan.section4_notification_report</field>
        <field name="report_file">bhuarjan.section4_notification_report</field>
        <field name="paperformat_id" ref="bhuarjan.bhuarjan_form10_paper_format"/>
        <field name="print_report_name">'Section4_Notification_' + ((object and object.project_id and object.project_id.name) or (docs and docs[0] and docs[0].project_id and docs[0].project_id.name) or 'All')</field>
    </record>

    <!-- Section 4 Notification Report Template -->
    <template id="section4_notification_report">
        <t t-call="web.html_container">
            <meta charset="utf-8"/>
            <style>
                @page {
                    margin: 1.5cm;
                    font-family: 'Noto Sans Devanagari', 'Mangal', 'Arial Unicode MS', 'DejaVu Sans', sans-serif;
                }
                body {
                    font-family: 'Noto Sans Devanagari', 'Mangal', 'Arial Unicode MS', 'DejaVu Sans', sans-serif;
                    direction: ltr;
                    font-size: 12px;
                    line-height: 1.6;
                }
                .header {
                    text-align: center;
                    margin-bottom: 20px;
                }
                .header h1 {
                    font-size: 20px;
                    font-weight: bold;
                    margin-bottom: 10px;
                    text-decoration: underline;
                }
                .notification-table {
                    width: 100%;
                    border-collapse: collapse;
                    margin-top: 20px;
                    border: 2px solid #000;
                }
                .notification-table th,
                .notification-table td {
                    border: 1px solid #000;
                    padding: 8px;
                    text-align: center;
                    font-size: 12px;
                }
                .notification-table th {
                    background-color: #f0f0f0;
                    font-weight: bold;
                }
                .notification-table td:nth-child(5) {
                    text-align: left;
                    padding-left: 10px;
                }
            </style>
            
            <t t-set="wizard" t-value="object or (docs and docs[0]) or None"/>
            <t t-if="wizard">
                <div class="header">
                    <h1>धारा 4 अधिसूचना</h1>
                    <h2>Section 4 Notification</h2>
                    <p><strong>परियोजना:</strong> <span t-esc="wizard.project_id.name or ''"/></p>
                </div>

                <div class="content">
                    <p style="text-align: right; margin-bottom: 10px;"><strong>अर्थात् :-</strong></p>
                    
                    <table class="notification-table">
                        <thead>
                            <tr>
                                <th style="width: 10%;"><strong>जिला</strong><br/>District</th>
                                <th style="width: 15%;"><strong>तहसील</strong><br/>Tehsil</th>
                                <th style="width: 20%;"><strong>ग्राम/नगर</strong><br/>Village/City</th>
                                <th style="width: 15%;"><strong>क्षेत्रफल</strong><br/>Area (Hectares)</th>
                                <th style="width: 40%;"><strong>लोक प्रयोजन का विवरण</strong><br/>Description of Public Purpose</th>
                            </tr>
                        </thead>
                        <tbody>
                            <t t-set="consolidated_data" t-value="wizard._get_consolidated_village_data()"/>
                            <t t-set="public_purpose" t-value="wizard.public_purpose or wizard.project_id.name or ''"/>
                            <t t-foreach="consolidated_data" t-as="v_data">
                                <tr>
                                    <td><t t-esc="v_data.get('district', 'Raigarh (Chhattisgarh)')"/></td>
                                    <td><t t-esc="v_data.get('tehsil', '')"/></td>
                                    <td><t t-esc="v_data.get('village_name', '')"/></td>
                                    <td><t t-esc="'{:.4f}'.format(v_data.get('total_area', 0.0))"/></td>
                                    <td><t t-esc="public_purpose"/></td>
                                </tr>
                            </t>
                        </tbody>
                    </table>
                </div>
            </t>
        </t>
    </template>
</odoo>

