<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Bulk Form 10 Table Report (one PDF with all surveys row-by-row) -->
    <record id="action_report_form10_bulk_table" model="ir.actions.report">
        <field name="name">Form 10 - Bulk Table</field>
        <field name="model">bhu.survey</field>
        <field name="report_type">qweb-pdf</field>
        <field name="report_name">bhuarjan.form10_bulk_table_report</field>
        <field name="report_file">bhuarjan.form10_bulk_table_report</field>
        <field name="paperformat_id" ref="bhuarjan.bhuarjan_landscape_paper_format"/>
        <field name="print_report_name">'Form10_Bulk_' + ((object and object.project_id and object.project_id.name) or (docs and docs[0] and docs[0].project_id and docs[0].project_id.name) or 'All')</field>
    </record>
    
    <!-- Custom Layout header and footer -->
    <template id="report_custom_external_layout">
        <!-- Multicompany -->
        <t t-if="not o and doc">
            <t t-set="o" t-value="doc"/>
        </t>
        <t t-if="o and 'company_id' in o">
            <t t-set="company" t-value="o.company_id"></t>
        </t>
        <t t-if="not o or not 'company_id' in o">
            <t t-set="company" t-value="res_company"></t>
        </t>
        <!-- Set first survey - check multiple possible variable names -->
        <t t-if="not first">
            <t t-if="surveys and len(surveys) &gt; 0">
                <t t-set="first" t-value="surveys[0]"/>
            </t>
            <t t-elif="docs and len(docs) &gt; 0">
                <t t-set="first" t-value="docs[0]"/>
            </t>
            <t t-elif="doc">
                <t t-set="first" t-value="doc"/>
            </t>
        </t>
        <!-- Custom Header -->
        <div class="header o_clearfix" style="width: 100%; margin-bottom: 20px;">
            <style>
                .header-info-table { 
                    width: 100%; 
                    border-collapse: collapse; 
                    font-size: 14px; 
                    border: 2px solid #000; 
                    margin-bottom: 0; 
                    table-layout: fixed;
                }
                .header-info-table td { 
                    border: 1px solid #000; 
                    padding: 6px; 
                    vertical-align: middle;
                }
                .header h2 {
                    margin: 0 0 12px 0;
                    text-align: center;
                }
                .bulk-form10-table {
                            border-collapse: collapse;
                            width: 100%;
                            table-layout: fixed;
                        }
                .bulk-form10-table thead th:nth-child(1),
                .bulk-form10-table tbody td:nth-child(1) { width: 2%; }
                .bulk-form10-table thead th:nth-child(2),
                .bulk-form10-table tbody td:nth-child(2) { width: 4%; }
                .bulk-form10-table thead th:nth-child(3),
                .bulk-form10-table tbody td:nth-child(3) { width: 3%; }
                .bulk-form10-table thead th:nth-child(4),
                .bulk-form10-table tbody td:nth-child(4) { width: 4%; }
                .bulk-form10-table thead th:nth-child(5),
                .bulk-form10-table tbody td:nth-child(5) { width: 10%; }
                .bulk-form10-table td, th {
                    border: 1px solid #000; 
                    font-size: 14px;
                    padding: 3px;
                    word-wrap: break-word;
                    overflow-wrap: break-word;
                    vertical-align: top;
                }
                .bulk-form10-table thead {
                    display: table-header-group;
                    -fs-table-paginate: paginate;
                }
                .bulk-form10-table thead tr {
                    page-break-inside: avoid;
                    page-break-after: avoid;
                }
                .bulk-form10-table thead th {
                    background-color: #D3D3D3;
                    color: #000000;
                    font-weight: bold;
                    position: relative;
                    page-break-inside: avoid;
                    border: 2px solid #000;
                    padding: 6px;
                    font-size: 14px;
                    line-height: 1.2;
                }
                /* Reduce yes/no column widths by 20% */
                .bulk-form10-table thead th:nth-child(6),
                .bulk-form10-table thead th:nth-child(7),
                .bulk-form10-table thead th:nth-child(8),
                .bulk-form10-table thead th:nth-child(9){
                    width: auto;
                    min-width: 3%;
                    max-width: 4%;
                }
                .table_th_2{
                    text-align:center; 
                    border: 2px solid #000; 
                    background-color: #D3D3D3; 
                    color: #000000; 
                    padding: 6px; 
                    font-size: 13px;
                }
                /* Fix for parentheses rendering - use Arial font for wkhtmltopdf */
                .paren-fix {
                    font-family: Arial, Helvetica, sans-serif !important;
                    font-size: inherit !important;
                    display: inline !important;
                }
                .table_th_2 .paren-fix,
                .table_th_1 .paren-fix {
                    font-family: Arial, Helvetica, sans-serif !important;
                }
                .table_th_1{
                    text-align:center; 
                    border: 2px solid #000; 
                    background-color: #D3D3D3; 
                    color: #000000; 
                    padding: 6px; 
                }
            </style>
            <h2 style="text-decoration: underline; margin: 0 0 12px 0; text-align: center; font-size: 28px; font-weight: bold;"><strong>भू अर्जन प्रारंभिक सर्वे प्रपत्र</strong></h2>

            <table class="header-info-table table1" >
                <tr>
                    <td rowspan="2" style="width: 8%; padding: 5px; text-align: center; vertical-align: middle;">
                        <!-- Logo -->
                        <img src="/bhuarjan/static/img/logo.png" 
                             alt="Logo" 
                             style="width: 80px; height: auto; max-width: 80px; display: block; margin: 0 auto; padding: 0; object-fit: contain;"/>
                    </td>
                    <td style="width: 42%;">
                        <strong>परियोजना का नाम :</strong>
                        <span t-if="first" t-field="first.project_id.name"/>
                    </td>
                    <td style="width: 42%;">
                        <strong>विभाग का नाम</strong>
                        <span t-if="first" t-field="first.department_id.name"/>
                    </td>
                    <td rowspan="2" style="width: 8%; padding: 5px; text-align: center; vertical-align: middle;">
                        <!-- QR Code -->
                        <t t-if="first">
                            <t t-set="qr_code_img" t-value="first.get_qr_code_data()"/>
                            <t t-set="qr_download_url" t-value="'https://bhuarjan.com/bhuarjan/form10/' + str(first.project_id.project_uuid or '') + '/' + str(first.village_id.village_uuid or '') + '/download'"/>
                            <t t-if="qr_code_img">
                                <a t-att-href="qr_download_url" style="display: block; width: 80px; height: 80px; margin: 0 auto; padding: 0; text-decoration: none;">
                                    <img t-att-src="'data:image/png;base64,' + qr_code_img" 
                                         alt="QR Code - Click to download PDF" 
                                         style="width: 80px; height: 80px; max-width: 80px; max-height: 80px; border: none; display: block; margin: 0; padding: 0; object-fit: contain;"/>
                                </a>
                            </t>
                            <t t-if="not qr_code_img">
                                <a t-att-href="qr_download_url" style="display: block; width: 80px; height: 80px; margin: 0 auto; padding: 0; text-decoration: none;">
                                    <div style="width: 80px; height: 80px; position: relative; border: 1px solid #ccc; background: white; margin: 0;">
                                        <div style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; display: flex; align-items: center; justify-content: center;">
                                            <div style="text-align: center; font-size: 8px;">
                                                <div style="font-weight: bold;">QR Code</div>
                                            </div>
                                        </div>
                                    </div>
                                </a>
                            </t>
                        </t>
                    </td>
                </tr>
                <tr>
                    <td style="width: 40%;">
                        <strong>ग्राम का नाम</strong>
                        <span t-if="first" t-field="first.village_id.name"/>
                        <br/>
                        <strong>सर्वे दिनाँक</strong>
                        <span t-if="first" t-field="first.survey_date" t-options="{'widget': 'date', 'format': 'dd/MM/yyyy'}"/>
                    </td>
                    <td style="width: 40%;">
                        <strong>तहसील का नाम</strong>
                        <span t-if="first" t-field="first.tehsil_id.name"/> <strong>जिला-रायगढ़ <span class="paren-fix">&#40;</span>छ.ग.<span class="paren-fix">&#41;</span></strong>
                    </td>
                </tr>
            </table>
            <table class="bulk-form10-table" style="border: 2px solid #000;">
                <thead>
                    <!-- Repeat headers on each page -->
                    <tr>
                        <th rowspan="2" class="table_th_1" style="width: 2%;"><strong>क्र.</strong></th>
                        <th rowspan="2" class="table_th_1" style="width: 4%;"><strong>प्रभावित खसरा क्रमांक</strong></th>
                        <th rowspan="2" class="table_th_1" style="width: 3%;"><strong>कुल रकबा <span class="paren-fix">&#40;</span>हे.में.<span class="paren-fix">&#41;</span></strong></th>
                        <th rowspan="2" class="table_th_1" style="width: 4%;"><strong>अर्जन हेतु प्रस्तावित क्षेत्रफल <span class="paren-fix">&#40;</span>हेक्टेयर<span class="paren-fix">&#41;</span></strong></th>
                        <th rowspan="2" class="table_th_1" style="width: 17%;"><strong>भूमिस्वामी का नाम</strong></th>
                        <th colspan="4" class="table_th_1"><strong>भूमि का प्रकार</strong></th>
                        <th colspan="3" class="table_th_1"><strong>भूमि पर स्थित वृक्ष की संख्या <span style="font-family: Arial, sans-serif;">(</span>प्रजातिवार<span style="font-family: Arial, sans-serif;">)</span></strong></th>
                        <th colspan="6" class="table_th_1"><strong>भूमि पर स्थित परिसंपत्तियों का विवरण</strong></th>
                    </tr>
                    <tr>
                        <th class="table_th_2"><strong>एक फसली</strong></th>
                        <th class="table_th_2"><strong>दो फसली</strong></th>
                        <th class="table_th_2"><strong>सिंचित</strong></th>
                        <th class="table_th_2"><strong>असिंचित</strong></th>
                        <th class="table_th_2"><strong>अविकसित</strong></th>
                        <th class="table_th_2"><strong>अर्द्ध विकसित</strong></th>
                        <th class="table_th_2"><strong>पूर्ण विकसित</strong></th>
                        <th class="table_th_2"><strong>मकान <span class="paren-fix">&#40;</span>कच्चा/पक्का<span class="paren-fix">&#41;</span> क्षेत्रफल वर्गफुट में</strong></th>
                        <th class="table_th_2"><strong>शेड <span class="paren-fix">&#40;</span>क्षेत्रफल वर्गफुट में<span class="paren-fix">&#41;</span></strong></th>
                        <th class="table_th_2"><strong>कुँआ <span class="paren-fix">&#40;</span>कच्चा/पक्का<span class="paren-fix">&#41;</span> <span class="paren-fix">&#40;</span>हाँ/नहीं<span class="paren-fix">&#41;</span></strong></th>
                        <th class="table_th_2"><strong>ट्यूबवेल / सम्बमर्शिबल पम्प फिटिंग सहित <span class="paren-fix">&#40;</span>हाँ/नहीं<span class="paren-fix">&#41;</span></strong></th>
                        <th class="table_th_2"><strong>तालाब <span class="paren-fix">&#40;</span>हाँ/नहीं<span class="paren-fix">&#41;</span></strong></th>
                        <th class="table_th_2"><strong>रिमार्क</strong></th>
                    </tr>
                </thead>
            </table>
            <br/>
            <br/>

        </div>
        <!-- Custom Footer -->
        <div class="footer o_standard_footer" style="position: relative;">
            <div style="margin-bottom: 15px; padding: 10px; text-align: left; font-size: 14px; font-weight: 700;">
                <strong>संलग्न :- प्रभावित भूमियों का बी-1, खसरा एवं नक्शा</strong>
            </div>
            <table style="width:100%; border: 1px solid white;">
                <tr>
                    <td style="width:20%; text-align:center; padding:6px; border: none;">
                        <p style="margin: 4px 0; font-size: 16px; font-weight: 700;">(हस्ताक्षर)</p>
                        <p style="margin: 4px 0; font-size: 16px; font-weight: 700;">अपेक्षक निकाय के</p>
                        <p style="margin: 4px 0; font-size: 16px; font-weight: 700;">अधिकृत प्रतिनिधि</p>
                        <p style="margin: 4px 0; font-size: 16px; font-weight: 700;">नाम -</p>
                        <p style="margin: 4px 0; font-size: 16px; font-weight: 700;">पदनाम</p>
                    </td>
                    <td style="width:20%; text-align:center; padding:6px; border: none;">
                        <p style="margin: 4px 0; font-size: 16px; font-weight: 700;">(हस्ताक्षर)</p>
                        <p style="margin: 4px 0; font-size: 16px; font-weight: 700;">तहसीलदार</p>
                        <p style="margin: 4px 0; font-size: 16px; font-weight: 700;">नाम -</p>
                    </td>
                    <td style="width:20%; text-align:center; padding:6px; border: none;">
                        <p style="margin: 4px 0; font-size: 16px; font-weight: 700;">(हस्ताक्षर)</p>
                        <p style="margin: 4px 0; font-size: 16px; font-weight: 700;">नायब तहसीलदार</p>
                        <p style="margin: 4px 0; font-size: 16px; font-weight: 700;">नाम -</p>
                    </td>
                    <td style="width:20%; text-align:center; padding:6px; border: none;">
                        <p style="margin: 4px 0; font-size: 16px; font-weight: 700;">(हस्ताक्षर)</p>
                        <p style="margin: 4px 0; font-size: 16px; font-weight: 700;">राजस्व निरीक्षक</p>
                        <p style="margin: 4px 0; font-size: 16px; font-weight: 700;">नाम-</p>
                        <p style="margin: 4px 0; font-size: 16px; font-weight: 700;">रा.नि.मं.</p>
                    </td>
                    <td style="width:20%; text-align:center; padding:6px; border: none;">
                        <p style="margin: 4px 0; font-size: 16px; font-weight: 700;">(हस्ताक्षर)</p>
                        <p style="margin: 4px 0; font-size: 16px; font-weight: 700;">पटवारी</p>
                        <p style="margin: 4px 0; font-size: 16px; font-weight: 700;">नाम-</p>
                        <p style="margin: 4px 0; font-size: 16px; font-weight: 700;">हल्का नम्बर</p>
                    </td>
                </tr>
            </table>
        </div>

        <div class="article o_report_layout_standard"
         t-att-data-oe-model="o and o._name"
         t-att-data-oe-id="o and o.id"
         t-att-data-oe-lang="o and o.env.context.get('lang')"
         style="margin-top: 0;">
        <t t-raw="0"/>
    </div>
        
    </template>


    <template id="form10_bulk_table_report">
        <!-- Odoo automatically populates 'docs' from res_ids passed to _render_qweb_pdf -->
        <!-- Set surveys from docs - handle both list and recordset -->
        <t t-set="surveys" t-value="docs if docs else (object and [object] or [])"/>
        <t t-set="first" t-value="surveys and len(surveys) > 0 and surveys[0] or (object or False)"/>
        <t t-call="web.html_container">
            <!-- Include centralized CSS styles -->
            <t t-call="bhuarjan.report_common_styles"/>
            <t t-call="bhuarjan.report_custom_external_layout">  
                <div class="page" style="position: relative;">
                    <!-- Watermark with Logo - Centered on Page -->
                    <style>
                        .bulk-form10-table {
                            border-collapse: collapse;
                            width: 100%;
                            table-layout: fixed;
                        }
                        .bulk-form10-table thead th:nth-child(1),
                        .bulk-form10-table tbody td:nth-child(1) { width: 2%; }
                        .bulk-form10-table thead th:nth-child(2),
                        .bulk-form10-table tbody td:nth-child(2) { width: 4%; }
                        .bulk-form10-table thead th:nth-child(3),
                        .bulk-form10-table tbody td:nth-child(3) { width: 3%; }
                        .bulk-form10-table thead th:nth-child(4),
                        .bulk-form10-table tbody td:nth-child(4) { width: 4%; }
                        .bulk-form10-table thead th:nth-child(5),
                        .bulk-form10-table tbody td:nth-child(5) { width: 10%; }
                        .bulk-form10-table td, th {
                            border: 1px solid #000; 
                            font-size: 14px;
                            padding: 3px;
                            word-wrap: break-word;
                            overflow-wrap: break-word;
                            vertical-align: top;
                        }
                        .bulk-form10-table thead {
                            display: table-header-group;
                            -fs-table-paginate: paginate;
                        }
                        .bulk-form10-table thead tr {
                            page-break-inside: avoid;
                            page-break-after: avoid;
                        }
                        .bulk-form10-table thead th {
                            background-color: #D3D3D3;
                            color: #000000;
                            font-weight: bold;
                            position: relative;
                            page-break-inside: avoid;
                            border: 2px solid #000;
                            padding: 6px;
                            font-size: 14px;
                            line-height: 1.2;
                        }
                        .bulk-form10-table tbody {
                            display: table-row-group;
                        }
                        <!-- .bulk-form10-table tbody tr {
                            page-break-inside: avoid !important;
                            page-break-after: auto;
                            page-break-before: auto;
                        }
                        .bulk-form10-table tbody td {
                            page-break-inside: avoid;
                            orphans: 3;
                            widows: 3;
                        } -->

                        .bulk-form10-table,
                        .bulk-form10-table tr,
                        .bulk-form10-table td,
                        .bulk-form10-table tbody {
                            page-break-inside: avoid !important;
                        }

                        .bulk-form10-table {
                            border-collapse: collapse;
                        }
                        .bulk-form10-table tbody td:nth-child(5) {
                            page-break-inside: avoid !important;
                            page-break-after: avoid !important;
                            page-break-before: avoid !important;
                            orphans: 2;
                            widows: 2;
                        }
                        /* Reduce yes/no column widths by 20% */
                        .bulk-form10-table thead th:nth-child(6),
                        .bulk-form10-table tbody td:nth-child(6),
                        .bulk-form10-table thead th:nth-child(7),
                        .bulk-form10-table tbody td:nth-child(7),
                        .bulk-form10-table thead th:nth-child(8),
                        .bulk-form10-table tbody td:nth-child(8),
                        .bulk-form10-table thead th:nth-child(9),
                        .bulk-form10-table tbody td:nth-child(9) {
                            width: auto;
                            min-width: 3%;
                            max-width: 4%;
                        }
                        /* Page settings */
                        @page {
                            margin-top: 9.5cm;
                            margin-bottom: 2cm;
                            margin-left: 1cm;
                            margin-right: 1cm;
                        }
                        .content-wrapper {
                            margin-top: 0;
                            padding-top: 0;
                        }
                        .bulk-form10-table {
                            margin-top: 0;
                        }
                    </style>
                    <div class="content-wrapper">
                        <table class="bulk-form10-table" style="border: 2px solid #000;">
                            
                            <tbody>
                                <!-- Debug: Show message if no docs/surveys -->
                                <t t-if="not docs or len(docs) == 0">
                                    <tr>
                                        <td colspan="18" style="text-align: center; padding: 20px; color: red; font-weight: bold;">
                                            No surveys found. Please check that surveys exist for the selected project and village.
                                            <br/>Number of surveys: <t t-esc="len(docs) if docs else 0"/>
                                        </td>
                                    </tr>
                                </t>
                                <!-- Iterate directly over docs (Odoo standard) -->
                                <t t-foreach="docs" t-as="s">
                                    <tr class="survey-row">
                                        <td style="text-align:center"><t t-esc="s_index + 1"/></td>
                                                <td style="text-align:center">
                                                    <t t-if="s.khasra_number">
                                                        <t t-esc="s.khasra_number"/>
                                                    </t>
                                                    <span t-if="not s.khasra_number" style="color:#dc3545;font-weight:bold">नहीं</span>
                                                </td>
                                                <td style="text-align:center">
                                                    <t t-if="s.total_area is not None">
                                                        <t t-esc="s.total_area"/>
                                                    </t>
                                                    <span t-if="s.total_area is None" style="color:#dc3545;font-weight:bold">नहीं</span>
                                                </td>
                                                <td style="text-align:center">
                                                    <t t-if="s.acquired_area is not None">
                                                        <t t-esc="s.acquired_area"/>
                                                    </t>
                                                    <span t-if="s.acquired_area is None" style="color:#dc3545;font-weight:bold">नहीं</span>
                                                </td>
                                                <td style="width: 17%;">
                                                    <t t-if="s.landowner_ids and len(s.landowner_ids) &gt; 0">
                                                        <t t-set="counter" t-value="1"/>
                                                        <t t-foreach="s.landowner_ids" t-as="lo">
                                                            <div style="page-break-inside: avoid !important;">
                                                                <t t-esc="counter"/>. <t t-esc="lo.name"/>
                                                                <t t-if="lo.father_name">
                                                                    &#160;पिता&#160;<t t-esc="lo.father_name"/>
                                                                </t>
                                                                <t t-elif="lo.spouse_name">
                                                                    &#160;पति&#160;<t t-esc="lo.spouse_name"/>
                                                                </t>
                                                            </div>
                                                            <t t-set="counter" t-value="counter + 1"/>
                                                        </t>
                                                    </t>
                                                    <span t-if="not (s.landowner_ids and len(s.landowner_ids) &gt; 0)" style="color:#dc3545;font-weight:bold">नहीं</span>
                                                </td>
                                                <td style="text-align:center"><span t-if="s.is_single_crop" style="color:#28a745;font-weight:bold">हाँ</span><span t-if="not s.is_single_crop" style="color:#dc3545;font-weight:bold">नहीं</span></td>
                                                <td style="text-align:center"><span t-if="s.is_double_crop" style="color:#28a745;font-weight:bold">हाँ</span><span t-if="not s.is_double_crop" style="color:#dc3545;font-weight:bold">नहीं</span></td>
                                                <td style="text-align:center"><span t-if="s.is_irrigated" style="color:#28a745;font-weight:bold">हाँ</span><span t-if="not s.is_irrigated" style="color:#dc3545;font-weight:bold">नहीं</span></td>
                                                <td style="text-align:center"><span t-if="s.is_unirrigated" style="color:#28a745;font-weight:bold">हाँ</span><span t-if="not s.is_unirrigated" style="color:#dc3545;font-weight:bold">नहीं</span></td>
                                                <td style="text-align:center; page-break-inside: avoid;">
                                                    <t t-if="s.tree_line_ids">
                                                        <t t-set="has_undeveloped" t-value="False"/>
                                                        <t t-foreach="s.tree_line_ids" t-as="tree_line">
                                                            <t t-set="dev_stage" t-value="tree_line.development_stage or ''"/>
                                                            <t t-if="tree_line.quantity and tree_line.quantity > 0 and dev_stage == 'undeveloped'">
                                                                <t t-set="has_undeveloped" t-value="True"/>
                                                                <div style="margin-bottom: 2px; white-space: pre-line;">
                                                                    <t t-esc="tree_line.tree_master_id.name if tree_line.tree_master_id else ''"/> - <t t-esc="tree_line.quantity or 0"/>
                                                                </div>
                                                            </t>
                                                        </t>
                                                        <span t-if="not has_undeveloped" style="color:#dc3545;font-weight:bold">नहीं</span>
                                                    </t>
                                                    <span t-if="not s.tree_line_ids" style="color:#dc3545;font-weight:bold">नहीं</span>
                                                </td>
                                                <td style="text-align:center; page-break-inside: avoid;">
                                                    <t t-if="s.tree_line_ids">
                                                        <t t-set="has_semi_developed" t-value="False"/>
                                                        <t t-foreach="s.tree_line_ids" t-as="tree_line">
                                                            <t t-set="dev_stage" t-value="tree_line.development_stage or ''"/>
                                                            <t t-if="tree_line.quantity and tree_line.quantity > 0 and dev_stage == 'semi_developed'">
                                                                <t t-set="has_semi_developed" t-value="True"/>
                                                                <div style="margin-bottom: 2px; white-space: pre-line;">
                                                                    <t t-esc="tree_line.tree_master_id.name if tree_line.tree_master_id else ''"/> - <t t-esc="tree_line.quantity or 0"/>
                                                                </div>
                                                            </t>
                                                        </t>
                                                        <span t-if="not has_semi_developed" style="color:#dc3545;font-weight:bold">नहीं</span>
                                                    </t>
                                                    <span t-if="not s.tree_line_ids" style="color:#dc3545;font-weight:bold">नहीं</span>
                                                </td>
                                                <td style="text-align:center; page-break-inside: avoid;">
                                                    <t t-if="s.tree_line_ids">
                                                        <t t-set="has_fully_developed" t-value="False"/>
                                                        <t t-foreach="s.tree_line_ids" t-as="tree_line">
                                                            <t t-set="dev_stage" t-value="tree_line.development_stage or ''"/>
                                                            <t t-if="tree_line.quantity and tree_line.quantity > 0 and dev_stage == 'fully_developed'">
                                                                <t t-set="has_fully_developed" t-value="True"/>
                                                                <div style="margin-bottom: 2px; white-space: pre-line;">
                                                                    <t t-esc="tree_line.tree_master_id.name if tree_line.tree_master_id else ''"/> - <t t-esc="tree_line.quantity or 0"/>
                                                                </div>
                                                            </t>
                                                        </t>
                                                        <span t-if="not has_fully_developed" style="color:#dc3545;font-weight:bold">नहीं</span>
                                                    </t>
                                                    <span t-if="not s.tree_line_ids" style="color:#dc3545;font-weight:bold">नहीं</span>
                                                </td>
                                                <td style="text-align:center">
                                                    <span t-if="s.has_house == 'yes' and s.house_type and s.house_area">
                                                        <t t-if="s.house_type == 'pakka'">पक्का</t>
                                                        <t t-if="s.house_type == 'kaccha'">कच्चा</t>
                                                        <t t-if="s.house_type != 'pakka' and s.house_type != 'kaccha'"><span t-esc="s.house_type"/></t> / <span t-esc="s.house_area or 0.0"/> वर्गफुट
                                                    </span>
                                                    <span t-if="s.has_house != 'yes'" style="color:#dc3545;font-weight:bold">नहीं</span>
                                                </td>
                                                <td style="text-align:center">
                                                    <span t-if="s.has_shed == 'yes' and s.shed_area">
                                                        <span t-esc="s.shed_area"/> वर्गफुट
                                                    </span>
                                                    <span t-if="s.has_shed != 'yes' or not s.shed_area" style="color:#dc3545;font-weight:bold">नहीं</span>
                                                </td>
                                                <td style="text-align:center">
                                                    <t t-set="well_count" t-value="s.well_count or 1"/>
                                                    <span t-if="s.has_well == 'yes' and s.well_type == 'kaccha'">
                                                        <span style="color:#28a745;font-weight:bold">हाँ-कच्चा</span>
                                                        <span t-if="well_count > 1" style="color:#28a745;font-weight:bold"> (<t t-esc="well_count"/>)</span>
                                                    </span>
                                                    <span t-if="s.has_well == 'yes' and s.well_type == 'pakka'">
                                                        <span style="color:#28a745;font-weight:bold">हाँ-पक्का</span>
                                                        <span t-if="well_count > 1" style="color:#28a745;font-weight:bold"> (<t t-esc="well_count"/>)</span>
                                                    </span>
                                                    <span t-if="s.has_well == 'yes' and not s.well_type">
                                                        <span style="color:#28a745;font-weight:bold">हाँ</span>
                                                        <span t-if="well_count > 1" style="color:#28a745;font-weight:bold"> (<t t-esc="well_count"/>)</span>
                                                    </span>
                                                    <span t-if="s.has_well != 'yes'" style="color:#dc3545;font-weight:bold">नहीं</span>
                                                </td>
                                                <td style="text-align:center">
                                                    <t t-set="tubewell_count" t-value="s.tubewell_count or 1"/>
                                                    <span t-if="s.has_tubewell == 'yes'">
                                                        <span style="color:#28a745;font-weight:bold">हाँ</span>
                                                        <span t-if="tubewell_count > 1" style="color:#28a745;font-weight:bold"> (<t t-esc="tubewell_count"/>)</span>
                                                    </span>
                                                    <span t-if="s.has_tubewell != 'yes'" style="color:#dc3545;font-weight:bold">नहीं</span>
                                                </td>
                                                <td style="text-align:center"><span t-if="s.has_pond == 'yes'" style="color:#28a745;font-weight:bold">हाँ</span><span t-if="s.has_pond != 'yes'" style="color:#dc3545;font-weight:bold">नहीं</span></td>
                                                <td style="page-break-inside: avoid;">
                                                    <t t-set="has_remarks" t-value="False"/>
                                                    <t t-if="s.has_traded_land == 'yes'">
                                                        <t t-set="has_remarks" t-value="True"/>
                                                        <div style="margin-bottom: 2px;">
                                                            व्यपवर्तित-<t t-esc="s.traded_land_area or 0.0"/> हेक्टेयर
                                                        </div>
                                                    </t>
                                                    <t t-if="s.crop_type_id and (s.crop_type_id.code == 'FALLOW' or 'पड़ती' in (s.crop_type_id.name or ''))">
                                                        <t t-set="has_remarks" t-value="True"/>
                                                        <div style="margin-bottom: 2px;">पड़ती भूमि</div>
                                                    </t>
                                                    <t t-if="s.remarks">
                                                        <t t-set="has_remarks" t-value="True"/>
                                                        <div style="margin-bottom: 2px;"><t t-esc="s.remarks"/></div>
                                                    </t>
                                                    <span t-if="not has_remarks" style="color:#dc3545;font-weight:bold">नहीं</span>
                                                </td>
                                            </tr>
                                </t>
                            </tbody>
                        </table>
                    </div>
                </div>
            </t>
        </t>
    </template>

    <!-- Form 10 Landscape Report Action -->
    <record id="action_report_form10_bulk_table_landscape" model="ir.actions.report">
        <field name="name">Form 10 - Bulk Table (Landscape)</field>
        <field name="model">bhu.survey</field>
        <field name="report_type">qweb-pdf</field>
        <field name="report_name">bhuarjan.form10_bulk_table_report_landscape</field>
        <field name="report_file">bhuarjan.form10_bulk_table_report_landscape</field>
        <field name="paperformat_id" ref="bhuarjan.bhuarjan_landscape_paper_format"/>
        <field name="print_report_name">'Form10_Bulk_Landscape_' + ((object and object.project_id and object.project_id.name) or (docs and docs[0] and docs[0].project_id and docs[0].project_id.name) or 'All')</field>
    </record>

    <!-- Form 10 Landscape Template -->
    <template id="form10_bulk_table_report_landscape">
        <!-- Odoo automatically populates 'docs' from res_ids passed to _render_qweb_pdf -->
        <!-- Set surveys from docs - handle both list and recordset -->
        <t t-set="surveys" t-value="docs if docs else (object and [object] or [])"/>
        <t t-set="first" t-value="surveys and len(surveys) > 0 and surveys[0] or (object or False)"/>
        <t t-call="web.html_container">
            <!-- Include centralized CSS styles -->
            <t t-call="bhuarjan.report_common_styles"/>
            <t t-call="bhuarjan.report_custom_external_layout">  
                <div class="page" style="position: relative;">
                    <!-- Watermark with Logo - Centered on Page -->
                    <div class="watermark">
                        <div class="watermark-circle"></div>
                        <t t-set="base_url" t-value="request.env['ir.config_parameter'].sudo().get_param('web.base.url')"/>
                        <img t-att-src="base_url + '/bhuarjan/static/img/logo.png'" alt="Logo Watermark" style="width: 100%; height: auto; object-fit: contain;"/>
                    </div>
                    <style>
                        .bulk-form10-table-landscape {
                            border-collapse: collapse;
                            width: 100%;
                            table-layout: fixed;
                        }
                        .bulk-form10-table-landscape thead th:nth-child(1),
                        .bulk-form10-table-landscape tbody td:nth-child(1) { width: 2%; }
                        .bulk-form10-table-landscape thead th:nth-child(2),
                        .bulk-form10-table-landscape tbody td:nth-child(2) { width: 4%; }
                        .bulk-form10-table-landscape thead th:nth-child(3),
                        .bulk-form10-table-landscape tbody td:nth-child(3) { width: 3%; }
                        .bulk-form10-table-landscape thead th:nth-child(4),
                        .bulk-form10-table-landscape tbody td:nth-child(4) { width: 4%; }
                        .bulk-form10-table-landscape thead th:nth-child(5),
                        .bulk-form10-table-landscape tbody td:nth-child(5) { width: 10%; }
                        .bulk-form10-table-landscape td, th {
                            border: 1px solid #000; 
                            font-size: 12px;
                            padding: 3px;
                            word-wrap: break-word;
                            overflow-wrap: break-word;
                            vertical-align: top;
                        }
                        .bulk-form10-table-landscape thead {
                            display: table-header-group;
                            -fs-table-paginate: paginate;
                        }
                        .bulk-form10-table-landscape thead tr {
                            page-break-inside: avoid;
                            page-break-after: avoid;
                        }
                        .bulk-form10-table-landscape thead th {
                            background-color: #D3D3D3;
                            color: #000000;
                            font-weight: bold;
                            position: relative;
                            page-break-inside: avoid;
                            border: 2px solid #000;
                            padding: 6px;
                            font-size: 12px;
                            line-height: 1.2;
                        }
                        .bulk-form10-table-landscape tbody {
                            display: table-row-group;
                        }
                        .bulk-form10-table-landscape,
                        .bulk-form10-table-landscape tr,
                        .bulk-form10-table-landscape td,
                        .bulk-form10-table-landscape tbody {
                            page-break-inside: avoid !important;
                        }
                        .bulk-form10-table-landscape {
                            border-collapse: collapse;
                        }
                        .bulk-form10-table-landscape tbody td:nth-child(5) {
                            page-break-inside: avoid !important;
                            page-break-after: avoid !important;
                            page-break-before: avoid !important;
                            orphans: 2;
                            widows: 2;
                        }
                        /* Reduce yes/no column widths by 20% */
                        .bulk-form10-table-landscape thead th:nth-child(6),
                        .bulk-form10-table-landscape tbody td:nth-child(6),
                        .bulk-form10-table-landscape thead th:nth-child(7),
                        .bulk-form10-table-landscape tbody td:nth-child(7),
                        .bulk-form10-table-landscape thead th:nth-child(8),
                        .bulk-form10-table-landscape tbody td:nth-child(8),
                        .bulk-form10-table-landscape thead th:nth-child(9),
                        .bulk-form10-table-landscape tbody td:nth-child(9) {
                            width: auto;
                            min-width: 3%;
                            max-width: 4%;
                        }
                        /* Page settings for landscape */
                        @page {
                            margin-top: 9.5cm;
                            margin-bottom: 2cm;
                            margin-left: 1cm;
                            margin-right: 1cm;
                            size: landscape;
                        }
                        .content-wrapper-landscape {
                            margin-top: 0;
                            padding-top: 0;
                        }
                        .bulk-form10-table-landscape {
                            margin-top: 0;
                        }
                        /* Fix for parentheses rendering - use Arial font for wkhtmltopdf */
                        .paren-fix {
                            font-family: Arial, Helvetica, sans-serif !important;
                            font-size: inherit !important;
                            display: inline !important;
                        }
                        .table_th_2 .paren-fix,
                        .table_th_1 .paren-fix {
                            font-family: Arial, Helvetica, sans-serif !important;
                        }
                    </style>
                    <div class="content-wrapper-landscape">
                        <table class="bulk-form10-table-landscape" style="border: 2px solid #000;">
                            <thead>
                                <!-- Repeat headers on each page -->
                                <tr>
                                    <th rowspan="2" class="table_th_1" style="width: 2%;"><strong>क्र.</strong></th>
                                    <th rowspan="2" class="table_th_1" style="width: 4%;"><strong>प्रभावित खसरा क्रमांक</strong></th>
                                    <th rowspan="2" class="table_th_1" style="width: 3%;"><strong>कुल रकबा <span class="paren-fix">&#40;</span>हे.में.<span class="paren-fix">&#41;</span></strong></th>
                                    <th rowspan="2" class="table_th_1" style="width: 4%;"><strong>अर्जन हेतु प्रस्तावित क्षेत्रफल <span class="paren-fix">&#40;</span>हेक्टेयर<span class="paren-fix">&#41;</span></strong></th>
                                    <th rowspan="2" class="table_th_1" style="width: 17%;"><strong>भूमिस्वामी का नाम</strong></th>
                                    <th colspan="4" class="table_th_1"><strong>भूमि का प्रकार</strong></th>
                                    <th colspan="3" class="table_th_1"><strong>भूमि पर स्थित वृक्ष की संख्या <span class="paren-fix">&#40;</span>प्रजातिवार<span class="paren-fix">&#41;</span></strong></th>
                                    <th colspan="6" class="table_th_1"><strong>भूमि पर स्थित परिसंपत्तियों का विवरण</strong></th>
                                </tr>
                                <tr>
                                    <th class="table_th_2"><strong>एक फसली</strong></th>
                                    <th class="table_th_2"><strong>दो फसली</strong></th>
                                    <th class="table_th_2"><strong>सिंचित</strong></th>
                                    <th class="table_th_2"><strong>असिंचित</strong></th>
                                    <th class="table_th_2"><strong>अविकसित</strong></th>
                                    <th class="table_th_2"><strong>अर्द्ध विकसित</strong></th>
                                    <th class="table_th_2"><strong>पूर्ण विकसित</strong></th>
                                    <th class="table_th_2"><strong>मकान <span class="paren-fix">&#40;</span>कच्चा/पक्का<span class="paren-fix">&#41;</span> क्षेत्रफल वर्गफुट में</strong></th>
                                    <th class="table_th_2"><strong>शेड <span class="paren-fix">&#40;</span>क्षेत्रफल वर्गफुट में<span class="paren-fix">&#41;</span></strong></th>
                                    <th class="table_th_2"><strong>कुँआ <span class="paren-fix">&#40;</span>कच्चा/पक्का<span class="paren-fix">&#41;</span> <span class="paren-fix">&#40;</span>हाँ/नहीं<span class="paren-fix">&#41;</span></strong></th>
                                    <th class="table_th_2"><strong>ट्यूबवेल / सम्बमर्शिबल पम्प फिटिंग सहित <span class="paren-fix">&#40;</span>हाँ/नहीं<span class="paren-fix">&#41;</span></strong></th>
                                    <th class="table_th_2"><strong>तालाब <span class="paren-fix">&#40;</span>हाँ/नहीं<span class="paren-fix">&#41;</span></strong></th>
                                    <th class="table_th_2"><strong>रिमार्क</strong></th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Debug: Show message if no docs/surveys -->
                                <t t-if="not docs or len(docs) == 0">
                                    <tr>
                                        <td colspan="18" style="text-align: center; padding: 20px; color: red; font-weight: bold;">
                                            No surveys found. Please check that surveys exist for the selected project and village.
                                            <br/>Number of surveys: <t t-esc="len(docs) if docs else 0"/>
                                        </td>
                                    </tr>
                                </t>
                                <!-- Iterate directly over docs (Odoo standard) -->
                                <t t-foreach="docs" t-as="s">
                                    <tr class="survey-row">
                                        <td style="text-align:center"><t t-esc="s_index + 1"/></td>
                                                <td style="text-align:center">
                                                    <t t-if="s.khasra_number">
                                                        <t t-esc="s.khasra_number"/>
                                                    </t>
                                                    <span t-if="not s.khasra_number" style="color:#dc3545;font-weight:bold">नहीं</span>
                                                </td>
                                                <td style="text-align:center">
                                                    <t t-if="s.total_area is not None">
                                                        <t t-esc="s.total_area"/>
                                                    </t>
                                                    <span t-if="s.total_area is None" style="color:#dc3545;font-weight:bold">नहीं</span>
                                                </td>
                                                <td style="text-align:center">
                                                    <t t-if="s.acquired_area is not None">
                                                        <t t-esc="s.acquired_area"/>
                                                    </t>
                                                    <span t-if="s.acquired_area is None" style="color:#dc3545;font-weight:bold">नहीं</span>
                                                </td>
                                                <td style="width: 17%;">
                                                    <t t-if="s.landowner_ids and len(s.landowner_ids) &gt; 0">
                                                        <t t-set="counter" t-value="1"/>
                                                        <t t-foreach="s.landowner_ids" t-as="lo">
                                                            <div style="page-break-inside: avoid !important;">
                                                                <t t-esc="counter"/>. <t t-esc="lo.name"/>
                                                                <t t-if="lo.father_name">
                                                                    &#160;पिता&#160;<t t-esc="lo.father_name"/>
                                                                </t>
                                                                <t t-elif="lo.spouse_name">
                                                                    &#160;पति&#160;<t t-esc="lo.spouse_name"/>
                                                                </t>
                                                            </div>
                                                            <t t-set="counter" t-value="counter + 1"/>
                                                        </t>
                                                    </t>
                                                    <span t-if="not (s.landowner_ids and len(s.landowner_ids) &gt; 0)" style="color:#dc3545;font-weight:bold">नहीं</span>
                                                </td>
                                                <td style="text-align:center"><span t-if="s.is_single_crop" style="color:#28a745;font-weight:bold">हाँ</span><span t-if="not s.is_single_crop" style="color:#dc3545;font-weight:bold">नहीं</span></td>
                                                <td style="text-align:center"><span t-if="s.is_double_crop" style="color:#28a745;font-weight:bold">हाँ</span><span t-if="not s.is_double_crop" style="color:#dc3545;font-weight:bold">नहीं</span></td>
                                                <td style="text-align:center"><span t-if="s.is_irrigated" style="color:#28a745;font-weight:bold">हाँ</span><span t-if="not s.is_irrigated" style="color:#dc3545;font-weight:bold">नहीं</span></td>
                                                <td style="text-align:center"><span t-if="s.is_unirrigated" style="color:#28a745;font-weight:bold">हाँ</span><span t-if="not s.is_unirrigated" style="color:#dc3545;font-weight:bold">नहीं</span></td>
                                                <td style="text-align:center; page-break-inside: avoid;">
                                                    <t t-if="s.tree_line_ids">
                                                        <t t-set="has_undeveloped" t-value="False"/>
                                                        <t t-foreach="s.tree_line_ids" t-as="tree_line">
                                                            <t t-set="dev_stage" t-value="tree_line.development_stage or ''"/>
                                                            <t t-if="tree_line.quantity and tree_line.quantity > 0 and dev_stage == 'undeveloped'">
                                                                <t t-set="has_undeveloped" t-value="True"/>
                                                                <div style="margin-bottom: 2px; white-space: pre-line;">
                                                                    <t t-esc="tree_line.tree_master_id.name if tree_line.tree_master_id else ''"/> - <t t-esc="tree_line.quantity or 0"/>
                                                                </div>
                                                            </t>
                                                        </t>
                                                        <span t-if="not has_undeveloped" style="color:#dc3545;font-weight:bold">नहीं</span>
                                                    </t>
                                                    <span t-if="not s.tree_line_ids" style="color:#dc3545;font-weight:bold">नहीं</span>
                                                </td>
                                                <td style="text-align:center; page-break-inside: avoid;">
                                                    <t t-if="s.tree_line_ids">
                                                        <t t-set="has_semi_developed" t-value="False"/>
                                                        <t t-foreach="s.tree_line_ids" t-as="tree_line">
                                                            <t t-set="dev_stage" t-value="tree_line.development_stage or ''"/>
                                                            <t t-if="tree_line.quantity and tree_line.quantity > 0 and dev_stage == 'semi_developed'">
                                                                <t t-set="has_semi_developed" t-value="True"/>
                                                                <div style="margin-bottom: 2px; white-space: pre-line;">
                                                                    <t t-esc="tree_line.tree_master_id.name if tree_line.tree_master_id else ''"/> - <t t-esc="tree_line.quantity or 0"/>
                                                                </div>
                                                            </t>
                                                        </t>
                                                        <span t-if="not has_semi_developed" style="color:#dc3545;font-weight:bold">नहीं</span>
                                                    </t>
                                                    <span t-if="not s.tree_line_ids" style="color:#dc3545;font-weight:bold">नहीं</span>
                                                </td>
                                                <td style="text-align:center; page-break-inside: avoid;">
                                                    <t t-if="s.tree_line_ids">
                                                        <t t-set="has_fully_developed" t-value="False"/>
                                                        <t t-foreach="s.tree_line_ids" t-as="tree_line">
                                                            <t t-set="dev_stage" t-value="tree_line.development_stage or ''"/>
                                                            <t t-if="tree_line.quantity and tree_line.quantity > 0 and dev_stage == 'fully_developed'">
                                                                <t t-set="has_fully_developed" t-value="True"/>
                                                                <div style="margin-bottom: 2px; white-space: pre-line;">
                                                                    <t t-esc="tree_line.tree_master_id.name if tree_line.tree_master_id else ''"/> - <t t-esc="tree_line.quantity or 0"/>
                                                                </div>
                                                            </t>
                                                        </t>
                                                        <span t-if="not has_fully_developed" style="color:#dc3545;font-weight:bold">नहीं</span>
                                                    </t>
                                                    <span t-if="not s.tree_line_ids" style="color:#dc3545;font-weight:bold">नहीं</span>
                                                </td>
                                                <td style="text-align:center">
                                                    <span t-if="s.has_house == 'yes' and s.house_type and s.house_area">
                                                        <t t-if="s.house_type == 'pakka'">पक्का</t>
                                                        <t t-if="s.house_type == 'kaccha'">कच्चा</t>
                                                        <t t-if="s.house_type != 'pakka' and s.house_type != 'kaccha'"><span t-esc="s.house_type"/></t> / <span t-esc="s.house_area or 0.0"/> वर्गफुट
                                                    </span>
                                                    <span t-if="s.has_house != 'yes'" style="color:#dc3545;font-weight:bold">नहीं</span>
                                                </td>
                                                <td style="text-align:center">
                                                    <span t-if="s.has_shed == 'yes' and s.shed_area">
                                                        <span t-esc="s.shed_area"/> वर्गफुट
                                                    </span>
                                                    <span t-if="s.has_shed != 'yes' or not s.shed_area" style="color:#dc3545;font-weight:bold">नहीं</span>
                                                </td>
                                                <td style="text-align:center">
                                                    <t t-set="well_count" t-value="s.well_count or 1"/>
                                                    <span t-if="s.has_well == 'yes' and s.well_type == 'kaccha'">
                                                        <span style="color:#28a745;font-weight:bold">हाँ-कच्चा</span>
                                                        <span t-if="well_count > 1" style="color:#28a745;font-weight:bold"> (<t t-esc="well_count"/>)</span>
                                                    </span>
                                                    <span t-if="s.has_well == 'yes' and s.well_type == 'pakka'">
                                                        <span style="color:#28a745;font-weight:bold">हाँ-पक्का</span>
                                                        <span t-if="well_count > 1" style="color:#28a745;font-weight:bold"> (<t t-esc="well_count"/>)</span>
                                                    </span>
                                                    <span t-if="s.has_well == 'yes' and not s.well_type">
                                                        <span style="color:#28a745;font-weight:bold">हाँ</span>
                                                        <span t-if="well_count > 1" style="color:#28a745;font-weight:bold"> (<t t-esc="well_count"/>)</span>
                                                    </span>
                                                    <span t-if="s.has_well != 'yes'" style="color:#dc3545;font-weight:bold">नहीं</span>
                                                </td>
                                                <td style="text-align:center">
                                                    <t t-set="tubewell_count" t-value="s.tubewell_count or 1"/>
                                                    <span t-if="s.has_tubewell == 'yes'">
                                                        <span style="color:#28a745;font-weight:bold">हाँ</span>
                                                        <span t-if="tubewell_count > 1" style="color:#28a745;font-weight:bold"> (<t t-esc="tubewell_count"/>)</span>
                                                    </span>
                                                    <span t-if="s.has_tubewell != 'yes'" style="color:#dc3545;font-weight:bold">नहीं</span>
                                                </td>
                                                <td style="text-align:center"><span t-if="s.has_pond == 'yes'" style="color:#28a745;font-weight:bold">हाँ</span><span t-if="s.has_pond != 'yes'" style="color:#dc3545;font-weight:bold">नहीं</span></td>
                                                <td style="page-break-inside: avoid;">
                                                    <t t-set="has_remarks" t-value="False"/>
                                                    <t t-if="s.has_traded_land == 'yes'">
                                                        <t t-set="has_remarks" t-value="True"/>
                                                        <div style="margin-bottom: 2px;">
                                                            व्यपवर्तित-<t t-esc="s.traded_land_area or 0.0"/> हेक्टेयर
                                                        </div>
                                                    </t>
                                                    <t t-if="s.crop_type_id and (s.crop_type_id.code == 'FALLOW' or 'पड़ती' in (s.crop_type_id.name or ''))">
                                                        <t t-set="has_remarks" t-value="True"/>
                                                        <div style="margin-bottom: 2px;">पड़ती भूमि</div>
                                                    </t>
                                                    <t t-if="s.remarks">
                                                        <t t-set="has_remarks" t-value="True"/>
                                                        <div style="margin-bottom: 2px;"><t t-esc="s.remarks"/></div>
                                                    </t>
                                                    <span t-if="not has_remarks" style="color:#dc3545;font-weight:bold">नहीं</span>
                                                </td>
                                            </tr>
                                </t>
                            </tbody>
                        </table>
                    </div>
                </div>
            </t>
        </t>
    </template>
</odoo>